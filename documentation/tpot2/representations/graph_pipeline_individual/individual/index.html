
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://epistasislab.github.io/tpot2/documentation/tpot2/representations/graph_pipeline_individual/individual/">
      
      
        <link rel="prev" href="../../../config/transformers/">
      
      
        <link rel="next" href="../templates/">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.6">
    
    
      
        <title>Individual - TPOT2</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../css/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tpot2.representations.graph_pipeline_individual.individual" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="TPOT2" class="md-header__button md-logo" aria-label="TPOT2" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TPOT2
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Individual
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/epistasislab/tpot2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="TPOT2" class="md-nav__button md-logo" aria-label="TPOT2" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    TPOT2
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/epistasislab/tpot2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../using/" class="md-nav__link">
        Using TPOT2
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          TPOT2 API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          TPOT2 API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tpot2_api/estimator/" class="md-nav__link">
        Estimator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tpot2_api/classifier/" class="md-nav__link">
        Classifier
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tpot2_api/regressor/" class="md-nav__link">
        Regressor
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tutorial/1_Estimators_Overview/" class="md-nav__link">
        1 Estimators Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tutorial/2_Defining_Search_Space_%28config_dicts%29/" class="md-nav__link">
        2 Defining Search Space (config dicts)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tutorial/3_Genetic_Feature_Set_Selectors/" class="md-nav__link">
        3 Genetic Feature Set Selectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tutorial/4_Symbolic_Regression_and_Classification/" class="md-nav__link">
        4 Symbolic Regression and Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tutorial/5_GraphPipeline/" class="md-nav__link">
        5 GraphPipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tutorial/6_SH_and_early_termination/" class="md-nav__link">
        6 SH and early termination
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tutorial/7_dask_parallelization/" class="md-nav__link">
        Parallelization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tutorial/8_Genetic_Algorithm_Overview/" class="md-nav__link">
        8 Genetic Algorithm Overview
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
          tpot2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          tpot2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../_version/" class="md-nav__link">
         version
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../base_evolver/" class="md-nav__link">
        Base evolver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../estimator_objective_functions/" class="md-nav__link">
        Estimator objective functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphsklearn/" class="md-nav__link">
        Graphsklearn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../individual/" class="md-nav__link">
        Individual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../logbook/" class="md-nav__link">
        Logbook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../objectives/" class="md-nav__link">
        Objectives
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../parent_selectors/" class="md-nav__link">
        Parent selectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../population/" class="md-nav__link">
        Population
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_11" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1_11" id="__nav_6_1_11_label" tabindex="0">
          builtin_modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1_11">
          <span class="md-nav__icon md-icon"></span>
          builtin_modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/arithmetictransformer/" class="md-nav__link">
        Arithmetictransformer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/column_one_hot_encoder/" class="md-nav__link">
        Column one hot encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/feature_encoding_frequency_selector/" class="md-nav__link">
        Feature encoding frequency selector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/feature_set_selector/" class="md-nav__link">
        Feature set selector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/feature_transformers/" class="md-nav__link">
        Feature transformers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/genetic_encoders/" class="md-nav__link">
        Genetic encoders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/imputer/" class="md-nav__link">
        Imputer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/one_hot_encoder/" class="md-nav__link">
        One hot encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/passthrough/" class="md-nav__link">
        Passthrough
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../builtin_modules/zero_count/" class="md-nav__link">
        Zero count
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_12" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1_12" id="__nav_6_1_12_label" tabindex="0">
          config
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1_12">
          <span class="md-nav__icon md-icon"></span>
          config
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/all_single_modules/" class="md-nav__link">
        All single modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/autoqtl_builtins/" class="md-nav__link">
        Autoqtl builtins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/classifiers/" class="md-nav__link">
        Classifiers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/hyperparametersuggestor/" class="md-nav__link">
        Hyperparametersuggestor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/mdr_configs/" class="md-nav__link">
        Mdr configs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/regressors/" class="md-nav__link">
        Regressors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/selectors/" class="md-nav__link">
        Selectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/special_configs/" class="md-nav__link">
        Special configs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/transformers/" class="md-nav__link">
        Transformers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_13" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6_1_13" id="__nav_6_1_13_label" tabindex="0">
          representations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_13_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6_1_13">
          <span class="md-nav__icon md-icon"></span>
          representations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_13_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_6_1_13_1" id="__nav_6_1_13_1_label" tabindex="0">
          graph_pipeline_individual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_13_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6_1_13_1">
          <span class="md-nav__icon md-icon"></span>
          graph_pipeline_individual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Individual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Individual
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual" class="md-nav__link">
    individual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual.GraphIndividual" class="md-nav__link">
    GraphIndividual
  </a>
  
    <nav class="md-nav" aria-label="GraphIndividual">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual.GraphIndividual.crossover" class="md-nav__link">
    crossover()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual.GraphKey" class="md-nav__link">
    GraphKey
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual.create_node" class="md-nav__link">
    create_node()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../templates/" class="md-nav__link">
        Templates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_13_2" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1_13_2" id="__nav_6_1_13_2_label" tabindex="0">
          subset_selector
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_13_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1_13_2">
          <span class="md-nav__icon md-icon"></span>
          subset_selector
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../subset_selector/subsetselector/" class="md-nav__link">
        Subsetselector
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_14" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1_14" id="__nav_6_1_14_label" tabindex="0">
          tpot_estimator
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1_14">
          <span class="md-nav__icon md-icon"></span>
          tpot_estimator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tpot_estimator/estimator/" class="md-nav__link">
        Estimator
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_14_2" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1_14_2" id="__nav_6_1_14_2_label" tabindex="0">
          templates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_14_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1_14_2">
          <span class="md-nav__icon md-icon"></span>
          templates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tpot_estimator/templates/tpottemplates/" class="md-nav__link">
        Tpottemplates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../contribute/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../cite/" class="md-nav__link">
        Citing TPOT2
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../support/" class="md-nav__link">
        Support
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../related/" class="md-nav__link">
        Related
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual" class="md-nav__link">
    individual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual.GraphIndividual" class="md-nav__link">
    GraphIndividual
  </a>
  
    <nav class="md-nav" aria-label="GraphIndividual">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual.GraphIndividual.crossover" class="md-nav__link">
    crossover()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual.GraphKey" class="md-nav__link">
    GraphKey
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tpot2.representations.graph_pipeline_individual.individual.create_node" class="md-nav__link">
    create_node()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Individual</h1>

<div class="doc doc-object doc-module">


<a id="tpot2.representations.graph_pipeline_individual.individual"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="tpot2.representations.graph_pipeline_individual.individual.GraphIndividual" class="doc doc-heading">
        <code>GraphIndividual</code>


<a href="#tpot2.representations.graph_pipeline_individual.individual.GraphIndividual" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>tpot2.<span title="tpot2.BaseIndividual">BaseIndividual</span></code></p>

  
      <p>An individual that contains a template for a graph sklearn pipeline. </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>root_config_dict</code></td>
          <td>
          </td>
          <td><p>A dictionary of methods and functions that return a dictionary of hyperparameters.
Used to create the root node of the graph.</p></td>
          <td>
                <code>dict with format {method class: param_function}</code>
          </td>
        </tr>
        <tr>
          <td><code>inner_config_dict</code></td>
          <td>
          </td>
          <td><p>A dictionary of methods and functions that return a dictionary of hyperparameters. 
Used to create the inner nodes of the graph. If None, uses root_config_dict.</p></td>
          <td>
                <code>dict with format {method class: param_function}</code>
          </td>
        </tr>
        <tr>
          <td><code>leaf_config_dict</code></td>
          <td>
          </td>
          <td><p>A dictionary of methods and functions that return a dictionary of hyperparameters.
Used to create the leaf nodes of the graph. If not None, then all leafs must be created from this dictionary. 
Otherwise leaves will be created from inner_config_dict.</p></td>
          <td>
                <code>dict with format {method class: param_function}</code>
          </td>
        </tr>
        <tr>
          <td><code>initial_graph</code></td>
          <td>
                <code>(nx.DiGraph or list)</code>
          </td>
          <td><p>A graph to initialize the individual with. 
If a list, it will initialize a linear graph with the methods in the list in the sequence provided.
If the items in the list are dictionaries, nodes will be itialized with those dictionaries.
Strings in the list correspond to the default configuration files. They can be 'Selector', 'Regressor', 'Transformer', 'Classifier'.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>max_depth</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The maximum depth of the graph as measured by the shortest distance from the root.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The maximum number of nodes in the graph.</p></td>
          <td>
                <code>np.inf</code>
          </td>
        </tr>
        <tr>
          <td><code>max_children</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The maximum number of children a node can have.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the individual.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>crossover_same_depth</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If true, then crossover will only occur between nodes of the same depth as measured by the shortest distance from the root.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>crossover_same_recursive_depth</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If the graph is recursive, then crossover will only occur between graphs of the same recursive depth as measured by the shortest distance from the root.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>tpot2/representations/graph_pipeline_individual/individual.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-68">  68</a></span>
<span class="normal"><a href="#__codelineno-0-69">  69</a></span>
<span class="normal"><a href="#__codelineno-0-70">  70</a></span>
<span class="normal"><a href="#__codelineno-0-71">  71</a></span>
<span class="normal"><a href="#__codelineno-0-72">  72</a></span>
<span class="normal"><a href="#__codelineno-0-73">  73</a></span>
<span class="normal"><a href="#__codelineno-0-74">  74</a></span>
<span class="normal"><a href="#__codelineno-0-75">  75</a></span>
<span class="normal"><a href="#__codelineno-0-76">  76</a></span>
<span class="normal"><a href="#__codelineno-0-77">  77</a></span>
<span class="normal"><a href="#__codelineno-0-78">  78</a></span>
<span class="normal"><a href="#__codelineno-0-79">  79</a></span>
<span class="normal"><a href="#__codelineno-0-80">  80</a></span>
<span class="normal"><a href="#__codelineno-0-81">  81</a></span>
<span class="normal"><a href="#__codelineno-0-82">  82</a></span>
<span class="normal"><a href="#__codelineno-0-83">  83</a></span>
<span class="normal"><a href="#__codelineno-0-84">  84</a></span>
<span class="normal"><a href="#__codelineno-0-85">  85</a></span>
<span class="normal"><a href="#__codelineno-0-86">  86</a></span>
<span class="normal"><a href="#__codelineno-0-87">  87</a></span>
<span class="normal"><a href="#__codelineno-0-88">  88</a></span>
<span class="normal"><a href="#__codelineno-0-89">  89</a></span>
<span class="normal"><a href="#__codelineno-0-90">  90</a></span>
<span class="normal"><a href="#__codelineno-0-91">  91</a></span>
<span class="normal"><a href="#__codelineno-0-92">  92</a></span>
<span class="normal"><a href="#__codelineno-0-93">  93</a></span>
<span class="normal"><a href="#__codelineno-0-94">  94</a></span>
<span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="k">class</span> <span class="nc">GraphIndividual</span><span class="p">(</span><span class="n">tpot2</span><span class="o">.</span><span class="n">BaseIndividual</span><span class="p">):</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    An individual that contains a template for a graph sklearn pipeline. </span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    root_config_dict : {dict with format {method class: param_function}} </span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        A dictionary of methods and functions that return a dictionary of hyperparameters.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        Used to create the root node of the graph.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    inner_config_dict : {dict with format {method class: param_function}} </span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        A dictionary of methods and functions that return a dictionary of hyperparameters. </span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        Used to create the inner nodes of the graph. If None, uses root_config_dict.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    leaf_config_dict : {dict with format {method class: param_function}} </span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        A dictionary of methods and functions that return a dictionary of hyperparameters.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        Used to create the leaf nodes of the graph. If not None, then all leafs must be created from this dictionary. </span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        Otherwise leaves will be created from inner_config_dict.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    initial_graph : (nx.DiGraph or list):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        A graph to initialize the individual with. </span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        If a list, it will initialize a linear graph with the methods in the list in the sequence provided.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        If the items in the list are dictionaries, nodes will be itialized with those dictionaries.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        Strings in the list correspond to the default configuration files. They can be &#39;Selector&#39;, &#39;Regressor&#39;, &#39;Transformer&#39;, &#39;Classifier&#39;.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    max_depth : (int)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        The maximum depth of the graph as measured by the shortest distance from the root.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    max_size : (int)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        The maximum number of nodes in the graph.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    max_children : (int)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        The maximum number of children a node can have.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    name : (str)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        The name of the individual.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    crossover_same_depth : (bool)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        If true, then crossover will only occur between nodes of the same depth as measured by the shortest distance from the root.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    crossover_same_recursive_depth : (bool)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        If the graph is recursive, then crossover will only occur between graphs of the same recursive depth as measured by the shortest distance from the root.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="n">root_config_dict</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="n">inner_config_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="n">leaf_config_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="n">initial_graph</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="n">max_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> 
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="n">linear_pipeline</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="n">crossover_same_depth</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                <span class="n">crossover_same_recursive_depth</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                <span class="n">unique_subset_values</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                <span class="n">initial_subset_values</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                <span class="p">):</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__debug</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_config_dict</span> <span class="o">=</span> <span class="n">root_config_dict</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inner_config_dict</span> <span class="o">=</span> <span class="n">inner_config_dict</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="o">=</span> <span class="n">leaf_config_dict</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">=</span> <span class="n">max_size</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_depth</span> <span class="o">=</span> <span class="n">crossover_same_depth</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_recursive_depth</span> <span class="o">=</span> <span class="n">crossover_same_recursive_depth</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_subset_values</span> <span class="o">=</span> <span class="n">unique_subset_values</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_subset_values</span> <span class="o">=</span> <span class="n">initial_subset_values</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_subset_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_subset_selector</span> <span class="o">=</span> <span class="n">tpot2</span><span class="o">.</span><span class="n">representations</span><span class="o">.</span><span class="n">SubsetSelector</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">unique_subset_values</span><span class="p">,</span> <span class="n">initial_set</span><span class="o">=</span><span class="n">initial_subset_values</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_graph</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">initial_graph</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">create_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span><span class="n">first_leaf</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_graph</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">initial_graph</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                    <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_node</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>                    <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;Selector&#39;</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                            <span class="kn">from</span> <span class="nn">tpot2.config</span> <span class="kn">import</span> <span class="n">selector_config_dictionary</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                            <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_node</span><span class="p">(</span><span class="n">selector_config_dictionary</span><span class="p">))</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                    <span class="k">elif</span>  <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;Regressor&#39;</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                            <span class="kn">from</span> <span class="nn">tpot2.config</span> <span class="kn">import</span> <span class="n">regressor_config_dictionary</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                            <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_node</span><span class="p">(</span><span class="n">regressor_config_dictionary</span><span class="p">))</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                    <span class="k">elif</span>  <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;Transformer&#39;</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                            <span class="kn">from</span> <span class="nn">tpot2.config</span> <span class="kn">import</span> <span class="n">transformer_config_dictionary</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                            <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_node</span><span class="p">(</span><span class="n">transformer_config_dictionary</span><span class="p">))</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                    <span class="k">elif</span>  <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;Classifier&#39;</span><span class="p">:</span> 
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                            <span class="kn">from</span> <span class="nn">tpot2.config</span> <span class="kn">import</span> <span class="n">classifier_config_dictionary</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                            <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_node</span><span class="p">(</span><span class="n">classifier_config_dictionary</span><span class="p">))</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="k">for</span> <span class="n">child</span><span class="p">,</span> <span class="n">parent</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">node_list</span><span class="p">,</span> <span class="n">node_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">node_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">create_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_config_dict</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">create_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span><span class="n">first_leaf</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_all_nodes</span><span class="p">()</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="c1">#self.root =list(nx.topological_sort(self.graph))[0]</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mutate_methods_list</span> <span class="o">=</span>     <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutate_hyperparameters</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">_mutate_replace_node</span><span class="p">,</span> 
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">_mutate_remove_node</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                                        <span class="p">]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">crossover_methods_list</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                                        <span class="c1">#self._crossover_swap_node,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                                        <span class="c1">#self._crossover_hyperparameters,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">_crossover_swap_branch</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                                        <span class="c1">#self._crossover_take_branch,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                                        <span class="c1">#self._crossover_swap_leaf_at_node,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                                        <span class="p">]</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mutate_methods_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutate_insert_inner_node</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">crossover_methods_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crossover_take_branch</span><span class="p">)</span> <span class="c1">#this is the only crossover method that can create inner nodes</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">linear_pipeline</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mutate_methods_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutate_insert_bypass_node</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">linear_pipeline</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mutate_methods_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutate_insert_leaf</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_subset_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">crossover_methods_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crossover_row_subsets</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mutate_methods_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutate_row_subsets</span> <span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimize_methods_list</span> <span class="o">=</span> <span class="p">[</span> <span class="c1">#self._optimize_optuna_single_method_full_pipeline,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">_optimize_optuna_all_methods_full_pipeline</span><span class="p">]</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="k">def</span> <span class="nf">select_config_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="c1">#check if the node is root, leaf, or inner</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1">#root</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_config_dict</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1">#leaf</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">else</span><span class="p">:</span> <span class="c1">#inner</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_config_dict</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">def</span> <span class="nf">initialize_all_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                <span class="k">continue</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">method_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="n">node</span><span class="o">.</span><span class="n">method_class</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>                <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">](</span><span class="n">config</span><span class="o">.</span><span class="n">hyperparametersuggestor</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">def</span> <span class="nf">fix_noncompliant_leafs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">leafs</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">compliant_leafs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">noncompliant_leafs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leafs</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="k">if</span> <span class="n">leaf</span><span class="o">.</span><span class="n">method_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span><span class="p">:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                <span class="n">compliant_leafs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="n">noncompliant_leafs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="c1">#find all good leafs. If no good leaves exist, create a new one</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">compliant_leafs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">NodeLabel</span><span class="p">(</span><span class="n">config_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="n">first_leaf</span><span class="o">.</span><span class="n">method_class</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">first_leaf</span><span class="o">.</span><span class="n">config_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="c1">#TODO: check when there is no new method</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="n">first_leaf</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">first_leaf</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="n">first_leaf</span><span class="o">.</span><span class="n">method_class</span><span class="p">](</span><span class="n">config</span><span class="o">.</span><span class="n">hyperparametersuggestor</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">compliant_leafs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="c1">#connect bad leaves to good leaves (making them internal nodes)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">noncompliant_leafs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">noncompliant_leafs</span><span class="p">:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">compliant_leafs</span><span class="p">))</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">def</span> <span class="nf">_merge_duplicated_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">graph_changed</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">merged</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="k">while</span><span class="p">(</span><span class="ow">not</span> <span class="n">merged</span><span class="p">):</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="n">node_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">merged</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">other_node</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">node_list</span><span class="p">,</span> <span class="n">node_list</span><span class="p">):</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="n">other_node</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_node</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                <span class="c1">#If nodes are same class/hyperparameters</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">method_class</span> <span class="o">==</span> <span class="n">other_node</span><span class="o">.</span><span class="n">method_class</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">==</span> <span class="n">other_node</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                    <span class="n">node_children</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                    <span class="n">other_node_children</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">other_node</span><span class="p">))</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                    <span class="c1">#if nodes have identical children, they can be merged</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                    <span class="k">if</span> <span class="n">node_children</span> <span class="o">==</span> <span class="n">other_node_children</span><span class="p">:</span> 
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                        <span class="k">for</span> <span class="n">other_node_parent</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">other_node</span><span class="p">)):</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                            <span class="k">if</span> <span class="n">other_node_parent</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">other_node_parent</span><span class="p">,</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">other_node</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>                        <span class="n">merged</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>                        <span class="n">graph_changed</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>                        <span class="k">break</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="k">return</span> <span class="n">graph_changed</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="c1">#returns a flattened pipeline</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="k">def</span> <span class="nf">flatten_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="n">flattened_full_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="n">remove_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">flattened_full_graph</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="n">flattened</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">flatten_pipeline</span><span class="p">(</span><span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>                <span class="n">roots</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">get_roots</span><span class="p">(</span><span class="n">flattened</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>                <span class="n">leaves</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">get_leaves</span><span class="p">(</span><span class="n">flattened</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>                <span class="n">n1_s</span> <span class="o">=</span> <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                <span class="n">n1_p</span> <span class="o">=</span> <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                <span class="n">remove_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>                <span class="n">flattened_full_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">flattened_full_graph</span><span class="p">,</span> <span class="n">flattened</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>                <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n1_s</span> <span class="k">for</span> <span class="n">n2</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">])</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>                <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n1_p</span> <span class="k">for</span> <span class="n">n2</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">])</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;recursive depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">depth</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">remove_list</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_subset_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">flattened_full_graph</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                <span class="k">if</span> <span class="s2">&quot;subset_values&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                    <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;subset_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_subset_selector</span><span class="o">.</span><span class="n">subsets</span><span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>                    <span class="c1">#intersection</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                    <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;subset_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;subset_values&quot;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_subset_selector</span><span class="o">.</span><span class="n">subsets</span><span class="p">))</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="k">return</span> <span class="n">flattened_full_graph</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="k">def</span> <span class="nf">get_num_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                <span class="n">num_nodes</span><span class="o">+=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_num_nodes</span><span class="p">()</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>                <span class="n">num_nodes</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="k">return</span> <span class="n">num_nodes</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">def</span> <span class="nf">export_nested_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">graph_pipeline_args</span><span class="p">):</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="n">flattened_full_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">remove_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="n">gp</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">export_pipeline</span><span class="p">(</span><span class="o">**</span><span class="n">graph_pipeline_args</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="n">n1_s</span> <span class="o">=</span> <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="n">n1_p</span> <span class="o">=</span> <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="n">remove_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">gp</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="n">gp</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n1_s</span><span class="p">])</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">gp</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n1_p</span><span class="p">])</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">remove_list</span><span class="p">:</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="n">flattened_full_graph</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">estimator_graph</span> <span class="o">=</span> <span class="n">flattened_full_graph</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="c1">#mapping = {node:node.method_class(**node.hyperparameters) for node in estimator_graph}</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="n">label_remapping</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">label_to_instance</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">estimator_graph</span><span class="p">:</span> 
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="n">found_unique_label</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="k">while</span> <span class="ow">not</span> <span class="n">found_unique_label</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="ow">is</span> <span class="n">tpot2</span><span class="o">.</span><span class="n">GraphPipeline</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;GraphPipeline_</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>                    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">_</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">label_to_instance</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                    <span class="n">found_unique_label</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="ow">is</span> <span class="n">tpot2</span><span class="o">.</span><span class="n">GraphPipeline</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                <span class="n">label_remapping</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>                <span class="n">label_to_instance</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                <span class="n">label_remapping</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                <span class="n">label_to_instance</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">(</span><span class="o">**</span><span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="n">estimator_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">estimator_graph</span><span class="p">,</span> <span class="n">label_remapping</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">label_to_instance</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="n">estimator_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="k">return</span> <span class="n">tpot2</span><span class="o">.</span><span class="n">GraphPipeline</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">estimator_graph</span><span class="p">,</span> <span class="o">**</span><span class="n">graph_pipeline_args</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="k">def</span> <span class="nf">export_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">graph_pipeline_args</span><span class="p">):</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="n">estimator_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_pipeline</span><span class="p">()</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="c1">#mapping = {node:node.method_class(**node.hyperparameters) for node in estimator_graph}</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">label_remapping</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">label_to_instance</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">estimator_graph</span><span class="p">:</span> 
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="n">found_unique_label</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="k">while</span> <span class="ow">not</span> <span class="n">found_unique_label</span><span class="p">:</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">_</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">label_to_instance</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                    <span class="n">found_unique_label</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="n">label_remapping</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>            <span class="n">label_to_instance</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">(</span><span class="o">**</span><span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="n">estimator_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">estimator_graph</span><span class="p">,</span> <span class="n">label_remapping</span><span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">label_to_instance</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="n">estimator_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="k">return</span> <span class="n">tpot2</span><span class="o">.</span><span class="n">GraphPipeline</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">estimator_graph</span><span class="p">,</span> <span class="o">**</span><span class="n">graph_pipeline_args</span><span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="k">def</span> <span class="nf">export_baikal</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_pipeline</span><span class="p">()</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">toposorted</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">toposorted</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="n">node_outputs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">baikal</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">baikal</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;Target&#39;</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toposorted</span><span class="p">)):</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>            <span class="n">node</span> <span class="o">=</span> <span class="n">toposorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1">#If this node had no inputs use X</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                <span class="n">this_inputs</span> <span class="o">=</span> <span class="n">X</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="k">else</span><span class="p">:</span> <span class="c1">#in node has inputs, get those</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="n">this_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">node_outputs</span><span class="p">[</span><span class="n">child</span><span class="p">]</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">)]</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="n">this_output</span> <span class="o">=</span> <span class="n">baikal</span><span class="o">.</span><span class="n">make_step</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">,</span> <span class="n">class_name</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)(</span><span class="o">**</span><span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">)(</span><span class="n">this_inputs</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="n">node_outputs</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_output</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">toposorted</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1">#last method doesn&#39;t need transformed.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                <span class="k">return</span> <span class="n">baikal</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">this_output</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_pipeline</span><span class="p">()</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span> <span class="c1">#self.graph.reverse()</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="c1">#TODO clean this up</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">planar_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>  <span class="c1"># positions for all nodes</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="k">except</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">shell_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="c1"># nodes</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">:</span> <span class="s1">&#39;tab:gray&#39;</span><span class="p">,</span> <span class="s1">&#39;node_size&#39;</span><span class="p">:</span> <span class="mi">800</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">}</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="n">nodelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">node_color</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Set1</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;recursive depth&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_color</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>  <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;edgelist = []</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        for n in n1.node_set:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">            for child in n.children:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">                edgelist.append((n,child))&#39;&#39;&#39;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="c1"># edges</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="c1">#nx.draw_networkx_edges(G, pos, width=3.0, arrows=True)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;nx.draw_networkx_edges(</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">            G,</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">            pos,</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">            edgelist=[edgelist],</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">            width=8,</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">            alpha=0.5,</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">            edge_color=&#39;tab:red&#39;,</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        )&#39;&#39;&#39;</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="c1"># some math labels</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="n">labels</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="n">labels</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">method_class</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="c1">#############</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="c1">#TODO currently does not correctly return false when adding a leaf causes a duplicate node that is later merged</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_graphindividual</span><span class="p">()</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="k">return</span> <span class="n">graph</span><span class="o">.</span><span class="n">_mutate</span><span class="p">()</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">def</span> <span class="nf">_mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mutate_methods_list</span><span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="k">for</span> <span class="n">mutate_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutate_methods_list</span><span class="p">:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="k">if</span> <span class="n">mutate_method</span><span class="p">():</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_merge_duplicated_nodes</span><span class="p">()</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__debug</span><span class="p">:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">mutate_method</span><span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lost root something went wrong with &#39;</span><span class="p">,</span> <span class="n">mutate_method</span><span class="p">)</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;root has parents &#39;</span><span class="p">,</span> <span class="n">mutate_method</span><span class="p">)</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">n</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">]):</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a node is connecting to itself...&#39;</span><span class="p">)</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__debug</span><span class="p">:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                            <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;something went wrong with &#39;</span><span class="p">,</span> <span class="n">mutate_method</span><span class="p">)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                        <span class="k">except</span><span class="p">:</span> 
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                            <span class="k">pass</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="k">def</span> <span class="nf">_mutate_row_subsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_subset_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_subset_selector</span><span class="o">.</span><span class="n">mutate</span><span class="p">()</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="k">def</span> <span class="nf">_mutate_hyperparameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        Mutates the hyperparameters for a randomly chosen node in the graph.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="n">sorted_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list</span><span class="p">)</span> 
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="k">continue</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="k">continue</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">](</span><span class="n">config</span><span class="o">.</span><span class="n">hyperparametersuggestor</span><span class="p">)</span> 
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="k">def</span> <span class="nf">_mutate_replace_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        Replaces the method in a randomly chosen node by a method from the available methods for that node.</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="n">sorted_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list</span><span class="p">)</span> 
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                <span class="k">continue</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>            <span class="n">node</span><span class="o">.</span><span class="n">method_class</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> 
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>                <span class="n">hyperparameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">]</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="k">else</span><span class="p">:</span> 
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                <span class="n">hyperparameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">](</span><span class="n">config</span><span class="o">.</span><span class="n">hyperparametersuggestor</span><span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>            <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">hyperparameters</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>    <span class="k">def</span> <span class="nf">_mutate_remove_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        Removes a randomly chosen node and connects its parents to its children.</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">        If the node is the only leaf for an inner node and &#39;leaf_config_dict&#39; is not none, we do not remove it.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="n">nodes_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="n">leaves</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">get_leaves</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>            <span class="n">node</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">nodes_list</span><span class="p">,)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>            <span class="n">nodes_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">descendants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span><span class="n">node</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> <span class="c1">#if the node is a leaf</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">leaves</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                    <span class="k">continue</span> <span class="c1">#dont remove the last leaf</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>                <span class="n">leaf_parents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>                <span class="c1"># if any of the parents of the node has one one child, continue</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>                <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">lp</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">lp</span> <span class="ow">in</span> <span class="n">leaf_parents</span><span class="p">]):</span> <span class="c1">#dont remove a leaf if it is the only input into another node.</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                <span class="n">graph_utils</span><span class="o">.</span><span class="n">remove_and_stitch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="n">graph_utils</span><span class="o">.</span><span class="n">remove_nodes_disconnected_from_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                <span class="n">graph_utils</span><span class="o">.</span><span class="n">remove_and_stitch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>                <span class="n">graph_utils</span><span class="o">.</span><span class="n">remove_nodes_disconnected_from_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>    <span class="k">def</span> <span class="nf">_mutate_remove_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        Deletes an edge as long as deleting that edge does not make the graph disconnected.</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="n">sorted_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list</span><span class="p">)</span> 
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="k">for</span> <span class="n">child_node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="n">parents</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">child_node</span><span class="p">))</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># if it has more than one parent, you can remove an edge (if this is the only child of a node, it will become a leaf)</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>                <span class="k">for</span> <span class="n">parent_node</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>                    <span class="c1"># if removing the egde will make the parent_node a leaf node, skip</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">parent_node</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span> 
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">parent_node</span><span class="p">,</span> <span class="n">child_node</span><span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                    <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>    <span class="k">def</span> <span class="nf">_mutate_add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">        Randomly add an edge from a node to another node that is not an ancestor of the first node.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="n">sorted_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list</span><span class="p">)</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="k">for</span> <span class="n">child_node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="k">for</span> <span class="n">parent_node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">parent_node</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>                <span class="c1"># skip if</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>                <span class="c1"># - parent and child are the same node</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>                <span class="c1"># - edge already exists</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>                <span class="c1"># - child is an ancestor of parent</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>                <span class="k">if</span>  <span class="p">(</span><span class="n">child_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">parent_node</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">parent_node</span><span class="p">,</span><span class="n">child_node</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">child_node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">parent_node</span><span class="p">)):</span>         
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">parent_node</span><span class="p">,</span><span class="n">child_node</span><span class="p">)</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>                    <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="k">def</span> <span class="nf">_mutate_insert_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">():</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>            <span class="n">sorted_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list</span><span class="p">)</span> <span class="c1">#TODO: sort by number of children and/or parents? bias model one way or another</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>                <span class="c1">#if leafs are protected, check if node is a leaf</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>                <span class="c1">#if node is a leaf, skip because we don&#39;t want to add node on top of node</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="c1">#if leafs are protected</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>                    <span class="ow">and</span>   <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1">#if node is leaf</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>                    <span class="ow">and</span>  <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">)))</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="c1">#except if node is root, in which case we want to add a leaf even if it happens to be a leaf too</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>                    <span class="p">):</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>                <span class="c1">#If node *is* the root or is not a leaf, add leaf node. (dont want to add leaf on top of leaf)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>                    <span class="n">new_node</span> <span class="o">=</span> <span class="n">create_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span><span class="p">)</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                    <span class="n">new_node</span> <span class="o">=</span> <span class="n">create_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_config_dict</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">new_node</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">new_node</span><span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="k">def</span> <span class="nf">_mutate_insert_bypass_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">():</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="n">sorted_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>            <span class="n">sorted_nodes_list2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list</span><span class="p">)</span> <span class="c1">#TODO: sort by number of children and/or parents? bias model one way or another</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list2</span><span class="p">)</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list</span><span class="p">:</span>  
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>                <span class="k">for</span> <span class="n">child_node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list2</span><span class="p">:</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>                    <span class="k">if</span> <span class="n">child_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">node</span> <span class="ow">and</span> <span class="n">child_node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>                            <span class="c1">#If if we are protecting leafs, dont add connection into a leaf</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">descendants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span><span class="n">node</span><span class="p">)))</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>                                <span class="k">continue</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>                            <span class="n">new_node</span> <span class="o">=</span> <span class="n">create_node</span><span class="p">(</span><span class="n">config_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_config_dict</span><span class="p">)</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">new_node</span><span class="p">)</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="n">node</span><span class="p">,</span> <span class="n">new_node</span><span class="p">),</span> <span class="p">(</span><span class="n">new_node</span><span class="p">,</span> <span class="n">child_node</span><span class="p">)])</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>                            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="k">def</span> <span class="nf">_mutate_insert_inner_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">():</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>            <span class="n">sorted_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="n">sorted_nodes_list2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list</span><span class="p">)</span> <span class="c1">#TODO: sort by number of children and/or parents? bias model one way or another</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sorted_nodes_list2</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">sorted_nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>                <span class="c1">#loop through children of node</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>                <span class="k">for</span> <span class="n">child_node</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">)):</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>                    <span class="k">if</span> <span class="n">child_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">node</span> <span class="ow">and</span> <span class="n">child_node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                            <span class="c1">#If if we are protecting leafs, dont add connection into a leaf</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">descendants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span><span class="n">node</span><span class="p">)))</span> <span class="o">==</span><span class="mi">0</span> <span class="p">:</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>                                <span class="k">continue</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>                            <span class="n">new_node</span> <span class="o">=</span> <span class="n">create_node</span><span class="p">(</span><span class="n">config_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_config_dict</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">new_node</span><span class="p">)</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="n">node</span><span class="p">,</span> <span class="n">new_node</span><span class="p">),</span> <span class="p">(</span><span class="n">new_node</span><span class="p">,</span> <span class="n">child_node</span><span class="p">)])</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">child_node</span><span class="p">)</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>                            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>    <span class="c1">######################################################</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>    <span class="c1"># Crossover</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="k">def</span> <span class="nf">get_graphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="n">graphs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;recursive depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>                <span class="n">node</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="n">graphs</span> <span class="o">=</span> <span class="n">graphs</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="n">_get_graphs</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>        <span class="k">return</span> <span class="n">graphs</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>    <span class="k">def</span> <span class="nf">_get_graphs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>        <span class="n">graphs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;recursive depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">depth</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                <span class="n">node</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                <span class="n">graphs</span> <span class="o">=</span> <span class="n">graphs</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="n">_get_graphs</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>        <span class="k">return</span> <span class="n">graphs</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="k">def</span> <span class="nf">select_graphindividual</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="n">graphs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_graphs</span><span class="p">()</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">graphs</span><span class="p">]</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">graphs</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="k">def</span> <span class="nf">select_graph_same_recursive_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span><span class="p">):</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>        <span class="n">graphs1</span> <span class="o">=</span> <span class="n">ind1</span><span class="o">.</span><span class="n">get_graphs</span><span class="p">()</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="n">weights1</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">graphs1</span><span class="p">]</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="n">graphs2</span> <span class="o">=</span> <span class="n">ind2</span><span class="o">.</span><span class="n">get_graphs</span><span class="p">()</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>        <span class="n">weights2</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">graphs2</span><span class="p">]</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>        <span class="n">g1_sorted_graphs</span> <span class="o">=</span> <span class="n">random_weighted_sort</span><span class="p">(</span><span class="n">graphs1</span><span class="p">,</span> <span class="n">weights1</span><span class="p">)</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="n">g2_sorted_graphs</span> <span class="o">=</span> <span class="n">random_weighted_sort</span><span class="p">(</span><span class="n">graphs2</span><span class="p">,</span> <span class="n">weights2</span><span class="p">)</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>        <span class="k">for</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">g1_sorted_graphs</span><span class="p">,</span> <span class="n">g2_sorted_graphs</span><span class="p">):</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="k">if</span> <span class="n">g1</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">g2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">g1</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;recursive depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">g2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;recursive depth&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                <span class="k">return</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="k">return</span> <span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>    <span class="k">def</span> <span class="nf">crossover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind2</span><span class="p">):</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">        self is the first individual, ind2 is the second individual</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">        If crossover_same_depth, it will select graphindividuals at the same recursive depth.</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">        Otherwise, it will select graphindividuals randomly from the entire graph and its subgraphs.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="sd">        This does not impact graphs without subgraphs. And it does not impacts nodes that are not graphindividuals. Cros</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="n">ind2</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_recursive_depth</span><span class="p">:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="c1"># selects graphs from the same recursive depth and same depth from the root</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>            <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_graph_same_recursive_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind2</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>            <span class="n">g1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_graphindividual</span><span class="p">()</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>            <span class="n">g2</span> <span class="o">=</span> <span class="n">ind2</span><span class="o">.</span><span class="n">select_graphindividual</span><span class="p">()</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="k">return</span> <span class="n">g1</span><span class="o">.</span><span class="n">_crossover</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>    <span class="k">def</span> <span class="nf">_crossover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crossover_methods_list</span><span class="p">)</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="k">for</span> <span class="n">crossover_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_methods_list</span><span class="p">:</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>            <span class="k">if</span> <span class="n">crossover_method</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_merge_duplicated_nodes</span><span class="p">()</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__debug</span><span class="p">:</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>                <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;something went wrong with &#39;</span><span class="p">,</span> <span class="n">crossover_method</span><span class="p">)</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>            <span class="k">except</span><span class="p">:</span> 
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                <span class="k">pass</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>    <span class="k">def</span> <span class="nf">_crossover_row_subsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G2</span><span class="p">):</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_subset_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">G2</span><span class="o">.</span><span class="n">unique_subset_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_subset_selector</span><span class="o">.</span><span class="n">crossover</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">row_subset_selector</span><span class="p">)</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>    <span class="k">def</span> <span class="nf">_crossover_swap_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G2</span><span class="p">):</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">        Swaps randomly chosen node from Parent1 with a randomly chosen node from Parent2.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_depth</span><span class="p">:</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_same_depth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_randomly</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>        <span class="k">for</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="ow">in</span> <span class="n">pair_gen</span><span class="p">:</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">node1</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">or</span> <span class="n">node2</span> <span class="ow">is</span> <span class="n">G2</span><span class="o">.</span><span class="n">root</span><span class="p">):</span> <span class="c1">#TODO: allow root</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>                <span class="n">n1_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node1</span><span class="p">)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>                <span class="n">n1_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node1</span><span class="p">)</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>                <span class="n">n2_s</span> <span class="o">=</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>                <span class="n">n2_p</span> <span class="o">=</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node1</span><span class="p">)</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>                <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="n">node2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n1_s</span><span class="p">])</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>                <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n2_s</span><span class="p">])</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">node2</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n1_p</span><span class="p">])</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>                <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">node1</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n2_p</span><span class="p">])</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>    <span class="k">def</span> <span class="nf">_crossover_swap_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G2</span><span class="p">):</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">        swaps a branch from parent1 with a branch from parent2. does not modify parent2</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_depth</span><span class="p">:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_same_depth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_randomly</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>        <span class="k">for</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="ow">in</span> <span class="n">pair_gen</span><span class="p">:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>            <span class="c1">#TODO: if root is in inner_config_dict, then do use it?</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>            <span class="k">if</span> <span class="n">node1</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">or</span> <span class="n">node2</span> <span class="ow">is</span> <span class="n">G2</span><span class="o">.</span><span class="n">root</span><span class="p">:</span> <span class="c1">#dont want to add root as inner node</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                <span class="k">continue</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>            <span class="c1">#check if node1 is a leaf and leafs are protected, don&#39;t add an input to the leave </span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1">#if we are protecting leaves, </span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>                <span class="n">node1_is_leaf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node1</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>                <span class="n">node2_is_leaf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node2</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>                <span class="c1">#if not ((node1_is_leaf and node1_is_leaf) or (not node1_is_leaf and not node2_is_leaf)): #if node1 is a leaf</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">node1_is_leaf</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">node2_is_leaf</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span> <span class="p">(</span><span class="ow">not</span> <span class="n">node1_is_leaf</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node2_is_leaf</span><span class="p">):</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>                    <span class="c1">#only continue if node1 and node2 are both leaves or both not leaves</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>            <span class="n">temp_graph_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>            <span class="n">temp_graph_1</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node1</span><span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>            <span class="n">graph_utils</span><span class="o">.</span><span class="n">remove_nodes_disconnected_from_node</span><span class="p">(</span><span class="n">temp_graph_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>            <span class="c1">#isolating the branch</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="n">branch2</span> <span class="o">=</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>            <span class="n">n2_descendants</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">descendants</span><span class="p">(</span><span class="n">branch2</span><span class="p">,</span><span class="n">node2</span><span class="p">)</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">branch2</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n2_descendants</span> <span class="ow">and</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">node2</span><span class="p">:</span> <span class="c1">#removes all nodes not in the branch</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>                    <span class="n">branch2</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>            <span class="n">branch2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">branch2</span><span class="p">)</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>            <span class="n">branch2_root</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">get_roots</span><span class="p">(</span><span class="n">branch2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="n">temp_graph_1</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">branch2</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node1</span><span class="p">)):</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>                <span class="n">temp_graph_1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">branch2_root</span><span class="p">)</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>            <span class="k">if</span> <span class="n">temp_graph_1</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>                <span class="k">continue</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">temp_graph_1</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="c1">#TODO: Currently returns true even if hyperparameters are blank</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>    <span class="k">def</span> <span class="nf">_crossover_hyperparameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G2</span><span class="p">):</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">        Swaps the hyperparamters of one randomly chosen node in Parent1 with the hyperparameters of randnomly chosen node in Parent2.</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_depth</span><span class="p">:</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_same_depth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_randomly</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>        <span class="k">for</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="ow">in</span> <span class="n">pair_gen</span><span class="p">:</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node2</span><span class="p">,</span><span class="n">GraphIndividual</span><span class="p">):</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>                <span class="k">continue</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>            <span class="k">if</span> <span class="n">node1</span><span class="o">.</span><span class="n">method_class</span> <span class="o">==</span> <span class="n">node2</span><span class="o">.</span><span class="n">method_class</span><span class="p">:</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">node1</span><span class="o">.</span><span class="n">hyperparameters</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>                <span class="n">node1</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">node2</span><span class="o">.</span><span class="n">hyperparameters</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>                <span class="n">node2</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">tmp</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>    <span class="c1">#not including the nodes, just their children</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>    <span class="c1">#Finds leaves attached to nodes and swaps them</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>    <span class="k">def</span> <span class="nf">_crossover_swap_leaf_at_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G2</span><span class="p">):</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_depth</span><span class="p">:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_same_depth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_randomly</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>        <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>        <span class="k">for</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="ow">in</span> <span class="n">pair_gen</span><span class="p">:</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>            <span class="c1"># if leaves are protected node1 and node2 must both be leaves or both be inner nodes </span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node1</span><span class="p">)))</span><span class="o">==</span><span class="mi">0</span> <span class="o">^</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node2</span><span class="p">)))</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>                <span class="k">continue</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>            <span class="c1">#self_leafs = [c for c in nx.descendants(self.graph,node1) if len(list(self.graph.successors(c)))==0 and c is not node1]</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>            <span class="n">node_leafs</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">descendants</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span><span class="n">node2</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">node2</span><span class="p">]</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>            <span class="c1"># if len(self_leafs) &gt;0:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>            <span class="c1">#     for c in self_leafs:</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>            <span class="c1">#         if random.choice([True,False]):</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>            <span class="c1">#             self.graph.remove_node(c)</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>            <span class="c1">#             G2.graph.add_edge(node2, c)</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>            <span class="c1">#             success = True</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_leafs</span><span class="p">)</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">node_leafs</span><span class="p">:</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>                    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">]):</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>                        <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>                        <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="k">return</span> <span class="n">success</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>    <span class="k">def</span> <span class="nf">_crossover_take_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G2</span><span class="p">):</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        Takes a subgraph from Parent2 and add it to a randomly chosen node in Parent1.</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_depth</span><span class="p">:</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_same_depth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>            <span class="n">pair_gen</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">select_nodes_randomly</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="k">for</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="ow">in</span> <span class="n">pair_gen</span><span class="p">:</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>            <span class="c1">#TODO: if root is in inner_config_dict, then do use it?</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>            <span class="k">if</span> <span class="n">node2</span> <span class="ow">is</span> <span class="n">G2</span><span class="o">.</span><span class="n">root</span><span class="p">:</span> <span class="c1">#dont want to add root as inner node</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>                <span class="k">continue</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>            <span class="c1">#check if node1 is a leaf and leafs are protected, don&#39;t add an input to the leave </span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_config_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node1</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>                <span class="k">continue</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>            <span class="c1">#icheck if node2 is graph individual</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>            <span class="c1"># if isinstance(node2,GraphIndividual):</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>            <span class="c1">#     if not ((isinstance(node2,GraphIndividual) and (&quot;Recursive&quot; in self.inner_config_dict or &quot;Recursive&quot; in self.leaf_config_dict))):</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>            <span class="c1">#         continue</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>            <span class="c1">#isolating the branch</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>            <span class="n">branch2</span> <span class="o">=</span> <span class="n">G2</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>            <span class="n">n2_descendants</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">descendants</span><span class="p">(</span><span class="n">branch2</span><span class="p">,</span><span class="n">node2</span><span class="p">)</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">branch2</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>                <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n2_descendants</span> <span class="ow">and</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">node2</span><span class="p">:</span> <span class="c1">#removes all nodes not in the branch</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>                    <span class="n">branch2</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>            <span class="c1">#if node1 plus node2 branch has more than max_children, skip</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>            <span class="k">if</span> <span class="n">branch2</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">:</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>                <span class="k">continue</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>            <span class="n">branch2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">branch2</span><span class="p">)</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>            <span class="n">branch2_root</span> <span class="o">=</span> <span class="n">graph_utils</span><span class="o">.</span><span class="n">get_roots</span><span class="p">(</span><span class="n">branch2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">branch2</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span><span class="n">branch2_root</span><span class="p">)</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>    <span class="c1">#TODO: swap all leaf nodes</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="k">def</span> <span class="nf">_crossover_swap_all_leafs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G2</span><span class="p">):</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="k">pass</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>    <span class="c1">#TODO: currently ignores ensembles, make it include nodes inside of ensembles</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>    <span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objective_function</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optimize_methods_list</span><span class="p">)</span> <span class="c1">#select an optimization method</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="k">for</span> <span class="n">optimize_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimize_methods_list</span><span class="p">:</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>            <span class="k">if</span> <span class="n">optimize_method</span><span class="p">(</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>    <span class="c1">#optimize the hyperparameters of one method to improve the entire pipeline</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="k">def</span> <span class="nf">_optimize_optuna_single_method_full_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objective_function</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>        <span class="n">nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">nodes_list</span><span class="p">)</span> <span class="c1">#TODO: sort by number of children and/or parents? bias model one way or another</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">NodeLabel</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">],</span><span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>                <span class="k">continue</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>                <span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>                <span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>                    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">](</span><span class="n">trial</span><span class="p">)</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>                    <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">params</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>                    <span class="n">trial</span><span class="o">.</span><span class="n">set_user_attr</span><span class="p">(</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>                    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>                        <span class="k">return</span> <span class="n">objective_function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>                    <span class="k">except</span><span class="p">:</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">NAN</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>                <span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>                <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">user_attrs</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>    <span class="c1">#optimize the hyperparameters of all methods simultaneously to improve the entire pipeline</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>    <span class="k">def</span> <span class="nf">_optimize_optuna_all_methods_full_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objective_function</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="n">nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>        <span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="n">nodes_to_optimize</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes_list</span><span class="p">:</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">NodeLabel</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">],</span><span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>                <span class="k">continue</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>                <span class="n">nodes_to_optimize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>            <span class="n">param_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes_to_optimize</span><span class="p">):</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>                <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_config_dict</span><span class="p">(</span><span class="n">node</span><span class="p">)[</span><span class="n">node</span><span class="o">.</span><span class="n">method_class</span><span class="p">](</span><span class="n">trial</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;node_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>                <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">params</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>                <span class="n">param_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>            <span class="n">trial</span><span class="o">.</span><span class="n">set_user_attr</span><span class="p">(</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">param_list</span><span class="p">)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>                <span class="k">return</span> <span class="n">objective_function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>            <span class="k">except</span><span class="p">:</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">NAN</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>        <span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>        <span class="n">best_params</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">user_attrs</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nodes_to_optimize</span><span class="p">,</span><span class="n">best_params</span><span class="p">):</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>            <span class="n">node</span><span class="o">.</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">params</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>    <span class="k">def</span> <span class="nf">_cached_transform</span><span class="p">(</span><span class="n">cache_nunber</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>        <span class="c1">#use a cache for models at each CV fold?</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>        <span class="c1">#cache just transformations at each fold?</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>        <span class="c1">#TODO how to separate full model?</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>        <span class="k">pass</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_pipeline</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>    <span class="k">def</span> <span class="nf">unique_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GraphKey</span><span class="p">:</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>            <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_pipeline</span><span class="p">()</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>                <span class="k">if</span> <span class="s2">&quot;subset_values&quot;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>                    <span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="o">.</span><span class="n">method_class</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">,</span> <span class="s2">&quot;subset_values&quot;</span><span class="p">:</span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;subset_values&quot;</span><span class="p">]}</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>                    <span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="o">.</span><span class="n">method_class</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">}</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>                <span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;method_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">method_class</span> <span class="c1">#TODO making this transformation doesn&#39;t feel very clean? </span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>                <span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;hyperparameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">hyperparameters</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>            <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">convert_node_labels_to_integers</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">GraphKey</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="tpot2.representations.graph_pipeline_individual.individual.GraphIndividual.crossover" class="doc doc-heading">
<code class="highlight language-python"><span class="n">crossover</span><span class="p">(</span><span class="n">ind2</span><span class="p">)</span></code>

<a href="#tpot2.representations.graph_pipeline_individual.individual.GraphIndividual.crossover" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>self is the first individual, ind2 is the second individual
If crossover_same_depth, it will select graphindividuals at the same recursive depth.
Otherwise, it will select graphindividuals randomly from the entire graph and its subgraphs.</p>
<p>This does not impact graphs without subgraphs. And it does not impacts nodes that are not graphindividuals. Cros</p>

      <details class="quote">
        <summary>Source code in <code>tpot2/representations/graph_pipeline_individual/individual.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="k">def</span> <span class="nf">crossover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind2</span><span class="p">):</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">    self is the first individual, ind2 is the second individual</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">    If crossover_same_depth, it will select graphindividuals at the same recursive depth.</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">    Otherwise, it will select graphindividuals randomly from the entire graph and its subgraphs.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="sd">    This does not impact graphs without subgraphs. And it does not impacts nodes that are not graphindividuals. Cros</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="n">ind2</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_same_recursive_depth</span><span class="p">:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="c1"># selects graphs from the same recursive depth and same depth from the root</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_graph_same_recursive_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind2</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="n">g1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_graphindividual</span><span class="p">()</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>        <span class="n">g2</span> <span class="o">=</span> <span class="n">ind2</span><span class="o">.</span><span class="n">select_graphindividual</span><span class="p">()</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="k">return</span> <span class="n">g1</span><span class="o">.</span><span class="n">_crossover</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="tpot2.representations.graph_pipeline_individual.individual.GraphKey" class="doc doc-heading">
        <code>GraphKey</code>


<a href="#tpot2.representations.graph_pipeline_individual.individual.GraphKey" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A class that can be used as a key for a graph.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>graph</code></td>
          <td>
                <code><span title="networkx">nx</span>.<span title="networkx.Graph">Graph</span></code>
          </td>
          <td><p>The graph to use as a key. Node Attributes are used for the hash.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>matched_label</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The node attribute to consider for the hash.</p></td>
          <td>
                <code>&#39;label&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>tpot2/representations/graph_pipeline_individual/individual.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="k">class</span> <span class="nc">GraphKey</span><span class="p">():</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    A class that can be used as a key for a graph.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    graph : (nx.Graph)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        The graph to use as a key. Node Attributes are used for the hash.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    matched_label : (str)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        The node attribute to consider for the hash.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">matched_label</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span><span class="c1">#[&#39;hyperparameters&#39;, &#39;method_class&#39;]) -&gt; None:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">matched_label</span> <span class="o">=</span> <span class="n">matched_label</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">node_match</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">node_match</span><span class="p">,</span> <span class="n">matched_labels</span><span class="o">=</span><span class="p">[</span><span class="n">matched_label</span><span class="p">])</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">weisfeiler_lehman_graph_hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_attr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">matched_label</span><span class="p">),</span><span class="mi">16</span><span class="p">)</span> <span class="c1">#hash(tuple(sorted([val for (node, val) in self.graph.degree()])))</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="c1">#If hash is different, node is definitely different</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="c1"># https://arxiv.org/pdf/2002.06653.pdf</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="c1">#If hash is same, use __eq__ to know if they are actually different</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_match</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">node_match</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="tpot2.representations.graph_pipeline_individual.individual.create_node" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_node</span><span class="p">(</span><span class="n">config_dict</span><span class="p">)</span></code>

<a href="#tpot2.representations.graph_pipeline_individual.individual.create_node" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Takes a config_dict and returns a node with a random method_class and hyperparameters</p>

      <details class="quote">
        <summary>Source code in <code>tpot2/representations/graph_pipeline_individual/individual.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="k">def</span> <span class="nf">create_node</span><span class="p">(</span><span class="n">config_dict</span><span class="p">):</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">    Takes a config_dict and returns a node with a random method_class and hyperparameters</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>    <span class="n">method_class</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">config_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>    <span class="c1">#if method_class == GraphIndividual or method_class == &#39;Recursive&#39;:</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>    <span class="k">if</span> <span class="n">method_class</span> <span class="o">==</span> <span class="s1">&#39;Recursive&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>        <span class="n">node</span> <span class="o">=</span> <span class="n">GraphIndividual</span><span class="p">(</span><span class="o">**</span><span class="n">config_dict</span><span class="p">[</span><span class="n">method_class</span><span class="p">])</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="n">method_class</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>            <span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">config_dict</span><span class="p">[</span><span class="n">method_class</span><span class="p">]</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>        <span class="k">else</span><span class="p">:</span> 
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>            <span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">config_dict</span><span class="p">[</span><span class="n">method_class</span><span class="p">](</span><span class="n">config</span><span class="o">.</span><span class="n">hyperparametersuggestor</span><span class="p">)</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>        <span class="n">node</span> <span class="o">=</span> <span class="n">NodeLabel</span><span class="p">(</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>                                        <span class="n">method_class</span><span class="o">=</span><span class="n">method_class</span><span class="p">,</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>                                        <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span><span class="p">)</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>    <span class="k">return</span> <span class="n">node</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["search.suggest", "search.highlight"], "search": "../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.51198bba.min.js"></script>
      
    
  </body>
</html>